<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,
                                   initial-scale=1,
                                   minimum-scale=1,
                                   maximum-scale=1,
                                   user-scalable=no,
                                   minimal-ui">
  
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
  
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
    <title>Third-party Caveats - Vanadium</title>
  
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300italic,400,400italic,500,500italic,700,700italic|Source+Code+Pro">
  
    <link rel="stylesheet" href="/css/github.css">
    <link rel="stylesheet" href="/css/material.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  
    <script src="/js/react-0.14.3.min.js"></script>
    <script src="/js/react-dom-0.14.3.min.js"></script>
  
    <link rel="apple-touch-icon" sizes="57x57" href="/favicons/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/favicons/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/favicons/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/favicons/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/favicons/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/favicons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/favicons/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/favicons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/favicons/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="160x160" href="/favicons/favicon-160x160.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/favicons/favicon-192x192.png">
    <meta name="msapplication-TileColor" content="#00acc1">
    <meta name="msapplication-TileImage" content="/favicons/mstile-144x144.png">
  
    <link rel="stylesheet" href="/css/bundle.css">
    <script src="/js/bundle.js"></script>
  </head>
  <body>
    <header class="mdl-shadow--2dp">
      <div class="row">
        <div class="icon menu"><i class="material-icons">menu</i></div>
        <div class="icon v-icon"><img src="/images/v-icon-white.svg"></div>
        <div class="logo"><a href="/">Vanadium</a></div>
        <div class="spacer"></div>
        <nav>
          <a href="/">Overview</a>
          <a href="/installation/">Installation</a>
          <a href="/tutorials/hello-world.html">Tutorials</a>
        </nav>
      </div>
    </header>
    <div class="sidebar"></div>
    <div class="sidebar-data">
      <a href="/">Overview</a>
      <a href="/installation/">Installation</a>
    
      <a href="#" class="nav">Tutorials</a>
      <nav>
        <a href="/tutorials/hello-world.html">Hello World</a>
        <a href="/tutorials/basics.html">Client/Server Basics</a>
    
        <a href="#" class="nav">Security</a>
        <nav>
          <a href="/tutorials/security/">Overview</a>
          <a href="/tutorials/security/principals-and-blessings.html">Principals and Blessings</a>
      <a href="/tutorials/security/permissions-authorizer.html">Permissions Authorizer</a>
      <a href="/tutorials/security/first-party-caveats.html">Caveats</a>
      <a href="/tutorials/security/third-party-caveats.html">Third-party Caveats</a>
      <a href="/tutorials/security/agent.html">The Agent</a>
      <a href="/tutorials/security/custom-authorizer.html">Custom Authorizer</a>
    </nav>
    
        <a href="#" class="nav">Naming</a>
        <nav>
          <a href="/tutorials/naming/">Overview</a>
          <a href="/tutorials/naming/mount-table.html">The Mount Table</a>
      <a href="/tutorials/naming/namespace.html">Namespaces</a>
      <a href="/tutorials/naming/suffix-part1.html">The Suffix - Part I</a>
      <a href="/tutorials/naming/suffix-part2.html">The Suffix - Part II</a>
      <a href="/tutorials/naming/globber.html">Globber</a>
    </nav>
    
        <a href="#" class="nav">Java</a>
        <nav>
          <a href="/tutorials/java/">Overview</a>
          <a href="/tutorials/java/fortune.html">Fortune in Java</a>
      <a href="/tutorials/java/android.html">Location Service in Android</a>
    </nav>
    
        <a href="#" class="nav">JavaScript</a>
        <nav>
          <a href="/tutorials/javascript/">Overview</a>
          <a href="/tutorials/javascript/hellopeer.html">Hello Peer</a>
      <a href="/tutorials/javascript/fortune.html">Fortune in JS</a>
      <a href="/tutorials/javascript/security.html">Security in JS</a>
    </nav>
    
        <a href="/tutorials/faq.html">Tutorial FAQ</a>
      </nav>
    
      <a href="#" class="nav">Concepts</a>
      <nav>
        <a href="/concepts/rpc.html">RPC System</a>
    <a href="/concepts/naming.html">Naming</a>
    <a href="/concepts/security.html">Security</a>
    <a href="/concepts/device-management.html">Device Management</a>
    <a href="/concepts/syncbase-overview.html">Syncbase</a>
  </nav>
    
      <a href="/example-apps.html">Example Apps</a>
      <a href="/api-reference.html">API Reference</a>
    
      <a href="#" class="nav">Community</a>
      <nav>
        <a href="/community/coding-guidelines.html">Coding Guidelines</a>
    <a href="/community/contributing.html">Contributing</a>
  </nav>
    
      <a href="#" class="nav">Tools</a>
      <nav>
        <a href="/tools/identity-service-faq.html">Vanadium Identity Service</a>
    <a href="/tools/jiri.html">Jiri</a>
    <a href="/tools/services.html">Vanadium Cloud Services</a>
    <a href="/tools/vanadium-chrome-extension.html">Vanadium Chrome Extension</a>
  </nav>
    
      <a href="#" class="nav">Design Docs</a>
      <nav>
        <a href="/designdocs/authentication.html">Authentication Protocol</a>
    <a href="/designdocs/identity-service.html">Identity Service</a>
    <a href="/designdocs/vdl-spec.html">VDL Specification</a>
    <a href="/designdocs/vom-spec.html">VOM Specification</a>
  </nav>
    
      <a href="/glossary.html">Glossary</a>
      <a href="/faq.html">FAQ</a>
      <a href="/tos.html">Terms of Service</a>
    </div>
    <main>
      <h1 class="title">
        
        Third-party Caveats
      </h1>

      <p class="wherein"><strong>Wherein</strong> you arrange for your lawyer to get access to your &quot;documents&quot;, then revoke that access.</p>

      <div class="toc"></div>

      <div class="prerequisites">
      <div class="note info"><p><strong>Prerequisites</strong>:<br>
All tutorials require Vanadium <a href="/installation/">installation</a>, and must run in a <a href="/tutorials/faq.html#why-bash-">bash shell</a>.
<br>Further, please <a href="/sh/scenario-d-setup.sh" download="scenario-d-setup.sh"> download this script</a> then <a href="/tutorials/faq.html#why-source-">source</a> it:</p>
<pre><code>source ~/Downloads/scenario-d-setup.sh
</code></pre><p>This command wipes tutorial files and defines shell environment variables. If you start a new terminal, and just want to re-establish the environment, see instructions <a href="/tutorials/setup.html">here</a>.
</p>
<p>Also:<ul>
<li>
This tutorial requires a <a href="https://accounts.google.com">Google account</a>.
</li>
</ul></p>
<p></p>
</div>
</div>

      <h1 id="introduction">Introduction</h1>
<p>Earlier you <a href="/tutorials/security/first-party-caveats.html">learned</a> how to add <a href="/glossary.html#caveat">caveats</a> to a
<a href="/glossary.html#blessing">blessing</a> to restrict its validity.  For example, one can make a
blessing expire after a few minutes, or restrict it to work only when
accessing a particular <em>method</em> on a service. These conditions are
validated by the <em>server</em> before allowing the client to invoke a
method.</p>
<p>This tutorial introduces
<a href="/glossary.html#third-party-caveat"><em>third-party caveats</em></a>. The restrictions encoded
in the caveat are validated by a third party that issues a proof of
validity called a <a href="/glossary.html#discharge">discharge</a>.  In this context the third party is
called a <a href="/glossary.html#discharger">discharger</a>.</p>
<p>The server simply verifies the discharges accompanying a request
instead of having to validate arbitrary conditions.</p>
<p>This tutorial will use a third-party caveat and a particular
discharger to demonstrate a <em>revocable</em> blessing.</p>
<h2 id="tutorial-sequence">Tutorial sequence</h2>
<p>Imagine that Alice is your lawyer, and you want her to access your
data stored in <a href="https://developers.google.com/drive/web">Google Drive</a>.</p>
<p>Vanadium is too new to be supported by Google Drive, so we&#39;ll
use a stand-in - your fortune service.  Your stand-in will,
however, demand real authentication via Google.</p>
<p>You will:</p>
<ul>
<li><p><strong>Seek a blessing</strong> associated with a real <a href="https://accounts.google.com">Google account</a> (yours).</p>
</li>
<li><p><strong>Run a fortune service</strong> as a new <a href="/glossary.html#principal">principal</a> named CheapDrive.</p>
<p>This local stand-in for a <a href="https://developers.google.com/drive/web">Google Drive</a> will demand that its
clients wield a blessing from the holder of a Google account.
You sought such a blessing, so you can use the service.</p>
</li>
<li><p><strong>Extend your blessing to Alice.</strong></p>
<p>Alice can then access <em>your</em> data at CheapDrive.</p>
</li>
<li><p><strong>Revoke the blessing</strong>.</p>
<p>Verify Alice no longer has access.</p>
</li>
</ul>
<p>The twist here is that Alice never needs a Google account, and you
give her access without contacting Google.</p>
<p>Google is contacted, however, to confirm her access and to revoke it.</p>
<h1 id="seek-a-blessing">Seek a blessing</h1>
<p>Set up some credentials:</p>
<!-- @initializeCredentials @test -->
<pre><code>$V_BIN/principal create --overwrite $V_TUT/cred/cheapDrive cheapDrive
$V_BIN/principal create --overwrite $V_TUT/cred/alice alice
$V_BIN/principal create --overwrite $V_TUT/cred/$USER $USER
</code></pre><p>Now you (really you) will use your Google account to <em>seek a blessing</em>:</p>
<!-- @seekBlessing -->
<pre><code>$V_BIN/principal \
    --v23.credentials $V_TUT/cred/$USER \
    seekblessings --from https://dev.v.io/auth/google
</code></pre><p>A browser will start up, log you into Google, ask you to approve
Vanadium access to your identity (details
<a href="#seeking-a-blessing">here</a>), and show you a web form.</p>
<p>In the <strong>Blessing Name</strong> section, in the <strong>extension</strong> field (read
about extensions <a href="#the-extension">here</a>) please enter:</p>
<!-- @extensionText -->
<pre><code>docs
</code></pre><p>Leave everything else in its default state, click <strong>BLESS</strong>, and
close the browser window.</p>
<p>The appendix provides a
<a href="#seeking-a-blessing">summary of what just happened</a>.</p>
<h2 id="examine-it">Examine it</h2>
<p>If all went well, you&#39;ve just stored a blessing from <code>dev.v.io</code> to
your credentials directory (<code>$V_TUT/cred/$USER</code>).</p>
<p>Examine the blessing&#39;s name as follows:</p>
<!-- @getUsersBlessingName @test -->
<pre><code>blessingName=`$V_BIN/principal \
    --v23.credentials $V_TUT/cred/$USER \
    get default -names`
echo $blessingName
</code></pre><p>It should look like:</p>
<pre><code class="noclipboard nohighlight">dev.v.io:u:${yourEmailAddress}:docs</code></pre>

<p>Blessing names are unforgeable.  Anyone who recognizes <code>dev.v.io</code> (the
<a href="/glossary.html#blessing-root">blessing root</a>) will know that someone blessed with a name in this
form has either directly authenticated with Google as
<code>${yourEmailAddress}</code>, or was blessed by someone who did.</p>
<p>By default, this blessing comes with a <em>third-party caveat</em> that
enables revocation.</p>
<p>Report the caveat on this blessing using a command
<a href="/tutorials/security/principals-and-blessings.html#caveats">introduced earlier</a>:</p>
<!-- @getTheCaveat @test -->
<pre><code>$V_BIN/principal \
    --v23.credentials $V_TUT/cred/$USER \
    get forpeer -caveats=$blessingName ...
</code></pre><p>The output should be something like</p>
<pre><code class="noclipboard nohighlight">ThirdPartyCaveat:
Requires discharge from /ns.dev.v.io:8101/identity/dev.v.io:u/discharger</code></pre>

<p>This reports the address of the caveat&#39;s <a href="/glossary.html#discharger">discharger</a>.</p>
<p>The discharger issues a <a href="/glossary.html#discharge">discharge</a> - proof that the
third-party caveat is valid. In this case the third-party caveat is a
revocation caveat and therefore the discharger issues a discharge only
if the corresponding blessing has not been revoked.  The revoked state
is simply a bit in a database behind the discharger.</p>
<p>This discharger is consulted on every attempt to use the blessing
(modulo <a href="/glossary.html#discharge">discharge caching</a>).</p>
<p>This will be demonstrated shortly.</p>
<h1 id="communicate">Communicate</h1>
<p>As mentioned <a href="#tutorial-sequence">above</a>, CheapDrive is going to run a
server, and various clients will try to use it.</p>
<h2 id="recognition">Recognition</h2>
<p>In previous tutorials, the server&#39;s principal in one form or another
<em>blessed</em> clients.  Those blessed automatically <em>recognize</em> their
blessers, and blessers honor the blessings they issue.</p>
<p>In this tutorial <em>the communicating peers won&#39;t be blessing each
other</em>.</p>
<p>As a Vanadium principal will ignore communication from an
<em>unrecognized</em> peer, we have to arrange for <em>recognition</em>.</p>
<h3 id="your-recognized-roots">Your recognized roots</h3>
<p>List the principals that <code>$USER</code> recognizes:</p>
<!-- @dumpUsersRecognition1 @test -->
<pre><code>$V_BIN/principal \
    --v23.credentials $V_TUT/cred/$USER \
    get recognizedroots
</code></pre><p>This command shows that principal <code>$USER</code> recognizes two principals -
itself, and <code>dev.v.io</code>.</p>
<p>Self recognition of of the name corresponding to the value of <code>$USER</code>
was established with the <code>principal create</code> command above.  This is an
example of a <a href="/glossary.html#self-blessing">self-blessing</a>.  Recognition of <code>dev.v.io</code> happened as a
result of seeking a blessing from <code>dev.v.io</code>.</p>
<p>Now, let <em>you</em>, as <code>$USER</code>, recognize CheapDrive so that you can make
requests to it later:</p>
<!-- @userRecognizesCheapDrive @test -->
<pre><code>$V_BIN/principal \
    --v23.credentials $V_TUT/cred/cheapDrive \
    get default | \
        $V_BIN/principal \
            --v23.credentials $V_TUT/cred/$USER \
            recognize -
</code></pre><p>This command says:</p>
<blockquote>
<p>Extract the blessing <code>cheapDrive</code> presents to clients, and then
arrange for <code>$USER</code> to recognize the principal that created said
blessing.</p>
</blockquote>
<p>In this case, the blessing creator was CheapDrive itself.</p>
<p>Confirm that <code>cheapDrive</code> now appears in the list of roots recognized by
<code>$USER</code>:</p>
<!-- @dumpUsersRecognition2 @test -->
<pre><code>$V_BIN/principal \
    --v23.credentials $V_TUT/cred/$USER \
    get recognizedroots
</code></pre><p>The key reported for <code>cheapDrive</code> should match the output of this
command:</p>
<!-- @dumpCheapDrivesKey @test -->
<pre><code>$V_BIN/principal \
    --v23.credentials $V_TUT/cred/cheapDrive \
    get publickey -pretty
</code></pre><h3 id="alice-s-recognized-roots">Alice&#39;s recognized roots</h3>
<p>Likewise, let Alice recognize CheapDrive:</p>
<!-- @aliceRecognizesCheapDrive @test -->
<pre><code>$V_BIN/principal \
    --v23.credentials $V_TUT/cred/cheapDrive \
    get default | \
        $V_BIN/principal \
            --v23.credentials $V_TUT/cred/alice \
            recognize -
</code></pre><p>Alice now recognizes CheapDrive.  CheapDrive has <strong>not</strong> blessed
Alice.  Nothing has happened that could be construed as delegation.</p>
<h3 id="cheapdrive-s-recognized-roots">CheapDrive&#39;s recognized roots</h3>
<p>Finally, let CheapDrive recognize <code>dev.v.io</code>:</p>
<!-- @cheapDriveRecognizesGoogle @test -->
<pre><code>$V_BIN/principal \
    --v23.credentials $V_TUT/cred/$USER \
    get default |
        $V_BIN/principal \
            --v23.credentials $V_TUT/cred/cheapDrive \
            recognize -
</code></pre><p>This last command relies on the fact that <code>$USER</code>&#39;s default blessing
came from <code>dev.v.io</code>.</p>
<p>These recognition steps will make more sense shortly.  The recognition
graph, excluding self-recognition, is shown below.</p>
<p><img src="/images/tut/security13-recognition-graph.svg" alt="Current recognition graph"></p>
<h2 id="permissions">Permissions</h2>
<p>In previous tutorials communicating parties blessed each other.</p>
<p>That won&#39;t be the case here.  CheapDrive won&#39;t bless anyone.</p>
<p>Instead, CheapDrive will configure, via a command line flag, a
<a href="/tutorials/security/permissions-authorizer.html">Permissions Authorizer</a> that allows a specific Google user (you) to
securely access CheapDrive&#39;s service.</p>
<p>Use the <code>$blessingName</code> you sought above to define a <a href="/glossary.html#permissions">Permissions</a>
specification for reading:</p>
<!-- @definePermissions @test -->
<pre><code>perms=`echo {\&quot;R\&quot;: {\&quot;In\&quot;: [\&quot;$blessingName\&quot;]}}`
echo $perms
</code></pre><p>Finally, start a server with those permissions.</p>
<!-- @startServer  -->
<pre><code>kill_tut_process TUT_PID_SERVER
$V_TUT/bin/server \
    --v23.credentials $V_TUT/cred/cheapDrive \
    --endpoint-file-name $V_TUT/server.txt \
    --perms &quot;$perms&quot; &amp;
TUT_PID_SERVER=$!
</code></pre><h2 id="make-requests">Make requests</h2>
<p>Make a request as You:</p>
<!-- @getYourFortune -->
<pre><code>$V_TUT/bin/client \
    --v23.credentials $V_TUT/cred/$USER \
    --server `cat $V_TUT/server.txt`
</code></pre><p>This request succeeds because the server was configured to accept your
blessing, and because the server recognizes the root of that blessing
(<code>dev.v.io</code>).</p>
<p>Now make a request as (your lawyer) Alice:</p>
<div class="note warning"><p>This request should fail.</p>
</div>

<!-- @aliceTriesAndFails -->
<pre><code>$V_TUT/bin/client \
    --v23.credentials $V_TUT/cred/alice \
    --server `cat $V_TUT/server.txt`
</code></pre><p>This fails because Alice lacks the proper blessing.</p>
<h2 id="bless-alice">Bless Alice</h2>
<p>Extend your <code>dev.v.io</code> blessing to Alice using
the <a href="#the-extension">extension</a> <code>lawyer</code>:</p>
<!-- @blessYourLawyer @test -->
<pre><code>$V_BIN/principal \
    --v23.credentials $V_TUT/cred/$USER \
    get default | \
        $V_BIN/principal \
            --v23.credentials $V_TUT/cred/$USER \
            bless --with=- --for=24h $V_TUT/cred/alice lawyer | \
                $V_BIN/principal \
                   --v23.credentials $V_TUT/cred/alice \
                   set forpeer - cheapDrive
</code></pre><p>Take a look at Alice&#39;s new blessing name:</p>
<!-- @blessYourLawyer @test -->
<pre><code>$V_BIN/principal get peermap \
    --v23.credentials $V_TUT/cred/alice | grep cheapDrive
</code></pre><p>The choice of <code>lawyer</code> as part of the name here will be shared only
with CheapDrive servers, since that was the argument of <code>forpeer</code>.</p>
<p>This blessing, and its hint that Alice is your lawyer, will not be
presented to any other peer that Alice interacts with.</p>
<p>Now Alice can examine your CheapDrive data:</p>
<!-- @aliceSucceeds -->
<pre><code>$V_TUT/bin/client \
    --v23.credentials $V_TUT/cred/alice \
    --server `cat $V_TUT/server.txt`
</code></pre><p>As long as Alice doesn&#39;t lose her credentials data, her requests will
continue to work - until you revoke the blessing.</p>
<h2 id="revoke-the-blessing">Revoke the blessing</h2>
<p>Visit <a href="https://dev.v.io/auth">dev.v.io/auth</a>, and click <strong>SHOW BLESSINGS</strong>.</p>
<p>Find the blessing you created in the
<a href="#seek-a-blessing">Seek a Blessing</a> step above, and click its
<strong>Revoke</strong> button.</p>
<p>Alice should no longer be able to read, i.e. this command should fail:</p>
<!-- @aliceShouldFail -->
<pre><code>$V_TUT/bin/client \
    --v23.credentials $V_TUT/cred/alice \
    --server `cat $V_TUT/server.txt`
</code></pre><h2 id="cleanup">Cleanup</h2>
<p>We&#39;re done with the server.</p>
<!-- @killServer @test -->
<pre><code>kill_tut_process TUT_PID_SERVER
</code></pre><p>The blessing you obtained above, which you&#39;ve just rendered useless,
nevertheless still consumes a tiny bit of disk space in
<code>$V_TUT/cred/$USER</code>.  Feel free to delete that, along with <code>$V_TUT</code> and
everything below it.</p>
<p>The record of the revoked blessing at <a href="https://dev.v.io/auth">dev.v.io/auth</a> will eventually
be removed from Google&#39;s servers. Its not possible to un-revoke it, so
there&#39;s no reason to keep it.</p>
<p>If you wish to revoke the <a href="https://developers.google.com/accounts/docs/OAuth2InstalledApp">OAuth</a> access you gave to Vanadium (it was
only needed to create a blessing for this tutorial), visit your
<a href="https://security.google.com/settings/security/permissions">Google settings</a>, click on <strong>Vanadium</strong>, and click <strong>Revoke access</strong>.</p>
<h1 id="summary">Summary</h1>
<ul>
<li><p>Third-party caveats are a means to add arbitrary conditions to
authorization.</p>
</li>
<li><p>The server doesn&#39;t bear the cost of their discharge - the third
party does.</p>
</li>
<li><p>A particular example of a third-party caveat is a revocable caveat,
where some third party holds the revocation bit.</p>
</li>
<li><p>Here we used Google to both broker authentication (convert your
Google login into a blessing protecting what could have been your
Google data) and to hold a bit allowing that blessing to be revoked.</p>
</li>
<li><p>&quot;Cheap Drive&quot; here was a stand-in for Google Drive - but the example
is unchanged if we imagine any cloud storage service that
incorporates Vanadium.  The Google login <em>controls only the
blessing</em>, not the service protected by the blessing.</p>
</li>
<li><p>You were able to extend your &quot;Google blessing&quot; to someone who didn&#39;t
have a Google account to allow them to access your data.</p>
</li>
<li><p>A different company could set up its own identity service to do
the same.</p>
</li>
</ul>
<h1 id="exercises">Exercises</h1>
<h2 id="skip-recognition">Skip recognition</h2>
<p>Start the tutorial again, and skip some of the recognitions steps.</p>
<p>Do the failures make sense?</p>
<h2 id="seek-multiple-blessings">Seek multiple blessings</h2>
<p>Use a different extension for each one.</p>
<p>In this way, you can retain a blessing for your own use, while
revoking the <code>docs</code> blessing.</p>
<h2 id="the-intern">The intern</h2>
<p>Can Alice give her intern Bob access to your data?</p>
<p>Does revocation of Alice&#39;s access also turn off Bob&#39;s access?</p>
<h1 id="appendix">Appendix</h1>
<h2 id="seeking-a-blessing">Seeking a blessing</h2>
<p>Here&#39;s what happened <a href="#seek-a-blessing">above</a> when you sought a blessing.</p>
<p>The <code>principal</code> program implicitly started listing on an <a href="/glossary.html#endpoint">endpoint</a>,
then encoded that endpoint as a parameter in a URL based on the
<code>--from</code> argument, then launched a browser loading that URL.  The
<code>principal</code> program then waited for a Vanadium RPC to appear on
the endpoint.</p>
<p>Behind the URL is an <a href="/glossary.html#identity-provider">identity provider</a>, an instance of Vanadium&#39;s
<a href="/designdocs/identity-service.html">identityd</a>, <a href="/glossary.html#self-blessing">self-blessed</a> with the name <code>dev.v.io</code>.</p>
<p>A web server associated with that provider told the browser to send
its user - <em>you</em> - to Google for login, then to an <a href="https://developers.google.com/accounts/docs/OAuth2InstalledApp">OAuth</a> grant
screen.  After completing that, it gave you a form for creating a
blessing.  When you clicked <strong>Bless</strong>, the form was submitted, and the
provider sent an RPC with the resulting blessing to the aforementioned
endpoint, to be stored in <code>$V_TUT/cred/$USER</code>.</p>
<p>For details, see this
<a href="/designdocs/identity-service.html">document describing the Vanadium identity service</a>.</p>
<h2 id="the-extension">The extension</h2>
<p>In the context of <em>extending a blessing</em>, the <em>extension</em> is just the
string appended to the <em>existing</em> blessing name to create the name
given to the <em>new</em> blessing.</p>
<p>It&#39;s handy to think of this as a categorization mechanism, like
directories.</p>
<p><a href="#seek-a-blessing">Above</a> you used <code>docs</code> as the extension in a
blessing you intended to extend to Alice so that she could access your
<em>documents</em>.</p>
<p>If the blessing had been intended to allow access to your email, you
might have used the extension <code>email</code>.</p>
<p>When you further extended the blessing to Alice, you specified
<code>lawyer</code> as the extension, so her blessing ending with <code>docs:lawyer</code>.</p>
<p>If Alice extended that blessing to her intern Bob, it would likely end
with <code>docs:lawyer:intern:bob</code>.  You might also extend a blessing to
<code>family</code> or <code>friends</code>, as Alice did in
<a href="/tutorials/security/first-party-caveats.html">earlier tutorials</a>.</p>
<p>Blessing names show up in server logs, facilitating access analysis.</p>

    </main>
    <nav class="previous-next">
      <a href="/tutorials/security/first-party-caveats.html" class="previous">
        <div class="icon"><i class="material-icons">arrow_back</i></div>
        <div class="text-wrapper">
          <small>Previous</small>
          <div class="text">
            <span>Caveats</span>
          </div>
        </div>
      </a>
  <a href="/tutorials/security/agent.html" class="next">
        <div class="text-wrapper">
          <small>Next</small>
          <div class="text">
            <span>The Agent</span>
          </div>
        </div>
        <div class="icon"><i class="material-icons">arrow_forward</i></div>
      </a>
</nav>
  </body>
</html>
